================================================================================
PROBLEM 2A - DETAILED ANSWER
Phase Offsets and Capacitance Values
================================================================================

QUESTION:
Assuming the start of the data file is T=0, what is the phase offset (in
samples) for each correlation peak, and what is the (relative) value of the
capacitance for each drive/sense pair?

ANSWER:

I found 5 correlation peaks by correlating the no-touch sense waveform with
the PRBS511 reference code. Each peak corresponds to one drive line.

--------------------------------------------------------------------------------
COMPLETE RESULTS TABLE:
--------------------------------------------------------------------------------

Drive/Sense Pair | Phase Offset (samples) | Capacitance (normalized)
-----------------|------------------------|-------------------------
Pair 1           | 21                     | 0.0795
Pair 2           | 151                    | 0.0718
Pair 3           | 276                    | 0.1493
Pair 4           | 341                    | 0.1004
Pair 5           | 432                    | 0.1049

--------------------------------------------------------------------------------
DETAILED BREAKDOWN:
--------------------------------------------------------------------------------

Drive/Sense Pair #1:
  Phase offset: 21 samples
  Correlation value: 40.64
  Capacitance (normalized): 40.64 / 511 = 0.0795

Drive/Sense Pair #2:
  Phase offset: 151 samples
  Correlation value: 36.69
  Capacitance (normalized): 36.69 / 511 = 0.0718

Drive/Sense Pair #3:
  Phase offset: 276 samples
  Correlation value: 76.32
  Capacitance (normalized): 76.32 / 511 = 0.1493

Drive/Sense Pair #4:
  Phase offset: 341 samples
  Correlation value: 51.33
  Capacitance (normalized): 51.33 / 511 = 0.1004

Drive/Sense Pair #5:
  Phase offset: 432 samples
  Correlation value: 53.62
  Capacitance (normalized): 53.62 / 511 = 0.1049

--------------------------------------------------------------------------------
EXPLANATION:
--------------------------------------------------------------------------------

Phase Offset:
The "phase offset" is the time delay (in samples) at which each drive line's
PRBS code appears in the sense signal. Since all 5 drives use the same PRBS511
sequence but with different starting phases, each drive creates a correlation
peak at a different delay.

For example:
- Drive 1 uses PRBS starting at phase 0 → peak at 21 samples
- Drive 2 uses PRBS starting at phase 130 → peak at 151 samples
- (The phase differences create orthogonal codes)

Capacitance Values:
The capacitance is proportional to the correlation peak height. I normalized
by dividing by the sequence length (511) to get a standardized value.

The capacitance values differ because:
1. Different drive lines are at different physical distances from the sense line
2. The sensor geometry affects the coupling strength
3. Drive 3 has the strongest coupling (0.1493) - probably closest to sense line
4. Drive 2 has the weakest coupling (0.0718) - probably farthest away

Physical Units:
These are "relative" capacitance values (normalized correlation). The actual
capacitance in picofarads would require knowing the voltage amplitude and
system calibration. But the relative values are sufficient for detecting
changes when a finger touches!

--------------------------------------------------------------------------------
VERIFICATION:
--------------------------------------------------------------------------------

Sanity checks that confirm these results are correct:

✓ Found exactly 5 peaks (one per drive line)
✓ All peaks are well-separated (minimum spacing > 50 samples)
✓ All capacitances are positive (physical requirement)
✓ Peak positions are consistent between no-touch and touch data
✓ Values are normalized between 0 and 1

See plot: problem2_complete_analysis.png, subplot (d)
The 5 red dots clearly show the correlation peaks at these positions.

================================================================================
SUMMARY FOR SUBMISSION:
================================================================================

Phase offsets (samples): 21, 151, 276, 341, 432
Capacitances (normalized): 0.0795, 0.0718, 0.1493, 0.1004, 0.1049

These values represent the baseline mutual capacitance between each drive line
and the sense line, measured using CDMA correlation with PRBS511 codes.

================================================================================
